<!DOCTYPE html>
<html>
<%- include('./Partials/header.ejs') %>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RTU-PDSMS</title>
  <!-- Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap">
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Custom CSS -->
  <link rel="stylesheet" href="Style.css">
</head>
<body>

<!-- navbar -->
<nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
  <div class="container-fluid">
      <a class="navbar-brand" href="#">RTU-PDSMS</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav align-right">
        <a class="nav-link" aria-current="page" href="/">Home</a>
        <a class="nav-link active" href="/dashboard">Sign Up</a>
        <a class="nav-link" href="#">Contacts</a>
      </div>
    </div>
  </div>
</nav>

  <!-- sign up -->
  <div class="container-fluid p-3 mt-5 minvh-100">
    <div class="row align-items-center d-flex justify-content-center">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h1 class="card-title text-center mb-4">Sign Up</h1>
            <form class="signup-form">
              <div class="form-group">
                <label for="firstname">First Name:</label>
                <div class="firstname error"></div>
                <input class="form-control" type="text" id="firstname" name="firstname" required>
              </div>

              <div class="form-group">
                <label for="lastname">Last Name:</label>
                <div class="lastname error"></div>
                <input class="form-control" type="text" id="lastname" name="lastname" required>
              </div>

              <div class="form-group">
                <label for="institutionalEmail">Institutional Email:</label>
                <div class="institutionalEmail error"></div>
                <input class="form-control" type="email" id="institutionalEmail" name="institutionalEmail" required>
              </div>

              <div class="form-group">
                <label for="password">Password: </label>
                <div class="password error"></div>
                <input class="form-control" type="password" id="password" name="password" required>
              </div>

              <div class="form-group">
                <label for="retypePassword">Re-type Password:</label>
                <input class="form-control" type="password" id="retypePassword" name="retypePassword" required>
              </div>

              <div class="form-check d-flex justify-content-center mt-3">
                <input class="form-check-input EULAcheck" type="checkbox" value="" id="flexCheckDefault" required onclick="handleCheckboxClick()">
                <label class="form-check-label" for="flexCheckDefault">I Agree to EULA Terms and Conditions</label>
              </div>

              <button type="submit" class="btn btn-primary btn-block">Signup</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <button type="button" class="btn btn-light bg-saved text-light" data-toggle="modal" data-target="#eulaform" id="modalTriggerBtn" style="display: none;">
    Open Modal
  </button>
</button>
  <div class="modal fade" id="eulaform"  data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <form method="POST" action="/uploadApprovedPDS" enctype="multipart/form-data" class="uploadForm" >
      <div class="modal-content">
        <div class="modal-header">
          End User License Agreement
        </div>
        <div class="modal-body p-5">
          <h4>1. Introduction</h4>
        <p>This Agreement constitutes the entire agreement between you and Charteuse regarding your access and use of the website (PD: Ease).</p>
        
        <h4>2. Acceptance of Terms</h4>
        <p>By accessing or using the PD: EASE, you agree to be bound by the terms and conditions set forth in this Agreement. If you disagree with any of the terms and conditions in this Agreement, you are not authorized to access or use the PD: EASE.</p>
        
        <h4>3. User Accounts</h4>
        <p>User responsibility and maintaining his/her account security could be discussed further, such as the importance of creating a strong password and not sharing login information.</p>
        <p>3.1. You may be required to create an account to access certain features of PD: EASE. You are responsible for maintaining the confidentiality of your account information, including your username and password. You are also responsible for all activities that occur under your account.</p>
        <p>3.2. You agree to keep your account information accurate and updated.</p>
        <p>3.3. You agree to notify us immediately of any unauthorized use of your account or any other security breach.</p>
        
        <h4>4. Use of the Website</h4>
        <p>Uses of this website are bound to comply with all applicable laws and regulations.</p>
        <p>4.1. You agree to use the Website in a manner that is lawful, ethical, and respectful of others.</p>
        <p>4.2. You agree not to use the Website for any purpose that is prohibited by law or regulation.</p>
        <p>4.3. You agree not to use the Website to harm or exploit others.</p>
        <p>4.4. You agree not to interfere with the operation of the Website.</p>
        <p>4.5. You agree not to impersonate any person or entity.</p>
        <p>4.6. You agree not to upload any content that is infringing, defamatory, obscene, or otherwise objectionable.</p>
        
        <h4>5. User Data</h4>
        <p>All the rights and responsibilities regarding user data are outlined in our Privacy Policy, which you agree to abide by when using the Website.</p>
        <p>5.1. You own all rights to the data that you store on the Website.</p>
        <p>5.2. We will not access your data except as necessary to provide the services offered by the Website.</p>
        <p>5.3. We will take reasonable steps to protect your data from unauthorized access or disclosure.</p>
        
        <h4>6. Termination</h4>
        <p>Upon the misuse of the website or violation of the terms outlined in this agreement, we reserve the right to terminate your access to the Website without prior notice.</p>
        <p>6.1. We may terminate your access to the Website at any time, for any reason, with or without notice.</p>
        <p>6.2. You may terminate your account at any time.</p>
        
        <h4>7. Governing Law</h4>
        <p>This Agreement shall be governed by and construed in accordance with the laws and standards of Privacy act of 2012 (Republic Act No. 10173, also known as the Data Privacy Act of 2012 (DPA), aims to protect personal data in information and communications systems both in the government and the private sector. The DPA created the National Privacy Commission (NPC) which is tasked to monitor its implementation.).</p>
        
        <h4>8. Disclaimer of Warranties</h4>
        <p>THE WEBSITE IS PROVIDED "AS IS" AND "AS AVAILABLE," WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, SUITABILITY FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT. WE DO NOT WARRANT THAT THE WEBSITE WILL BE UNINTERRUPTED OR ERROR-FREE.</p>
        
        <h4>9. Limitation of Liability</h4>
        <p>WE WILL NOT BE LIABLE FOR ANY DAMAGES ARISING OUT OF OR RELATED TO YOUR USE OF THE WEBSITE, INCLUDING BUT NOT LIMITED TO DIRECT, INDIRECT, INCIDENTAL, CONSEQUENTIAL, OR SPECIAL DAMAGES.</p>
        
        <h4>10. Dispute Resolution</h4>
        <p>Any dispute arising out of or relating to this Agreement shall be resolved by messaging us or contacting the appropriate customer service department. If the dispute cannot be resolved through those means, it may be subject to arbitration in accordance with the terms outlined in the Agreement.</p>
        
        <h4>11. Entire Agreement</h4>
        <p>This Agreement constitutes the entire agreement between you and us regarding your access and use of the Website.</p>
        
        <h4>12. Severability</h4>
        <p>If any provision of this Agreement is held to be invalid or unenforceable, such provision shall be struck and the remaining provisions shall remain in full force and effect.</p>
        
        <h4>13. Waiver</h4>
        <p>No waiver of any provision of this Agreement shall be deemed a further or continuing waiver of such provision or any other provision.</p>
        
        <h4>14. Updates to the Terms of Service</h4>
        <p>We may update the Terms of Service from time to time. We will notify you of any changes by posting the new Terms of Service on the Website. You are advised to review the Terms of Service periodically for any changes. Your continued use of the Website after the posting of any changes indicates your acceptance of those changes.</p>
        
        <h4>15. Contact Us</h4>
        <p>If you have any questions about the Terms of Service, please contact us at emailnggroupnatin.@gmail.com.</p>
        
        <hr>
        
        <h5>Acceptance</h5>
        <p>BY SIGNING UP FOR AN ACCOUNT, YOU ARE STATING THAT YOU HAVE READ, UNDERSTOOD AND AGREE TO BE BOUND BY THIS END USER LICENSE AGREEMENT.</p>
        <p>(IF YOU ARE REPRESENTING YOUR COMPANY, BY SIGNING UP FOR AN ACCOUNT, YOU ARE REPRESENTING THAT YOU HAVE THE REQUISITE CAPACITY AND AUTHORITY TO ENTER INTO THIS AGREEMENT, AND USE THE SERVICES. YOU FURTHER REPRESENT THAT YOU HAVE READ, UNDERSTOOD, AND AGREE TO BE BOUND BY THIS END USER LICENSE AGREEMENT.)</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Accept</button>
        </div>
      </div>
    </form>
    </div>
  </div>

<script>
        const signupform = document.querySelector('form');
        const institutionalEmailError = document.querySelector('.institutionalEmail.error');
        const passwordError = document.querySelector('.password.error');
        const firstnameError = document.querySelector('.firstname.error');
        const lastnameError = document.querySelector('.lastname.error');

        signupform.addEventListener('submit', async (e) => {
          e.preventDefault();

          const firstname = signupform.firstname.value;
          const lastname = signupform.lastname.value;
          const institutionalEmail = signupform.institutionalEmail.value;
          const password = signupform.password.value;
          const retypePassword = signupform.retypePassword.value;

          //reset errors 
              institutionalEmailError.textContent = '';
              passwordError.textContent = '';
              firstnameError.textContent = '';
              lastnameError.textContent = '';

          try{
            if(retypePassword === password) {
              const res = await fetch('/signup', {
                method: 'POST',
                body: JSON.stringify({firstname, lastname, institutionalEmail, password}),
                headers: { 'Content-Type': 'application/json' }
              });
              const data = await res.json();
              console.log(data);
              if(data.errors){
                firstnameError.textContent = data.errors.firstname;
                lastnameError.textContent = data.errors.lastname;
                institutionalEmailError.textContent = data.errors.institutionalEmail;
                passwordError.textContent = data.errors.password;
              }
              if (data.user){
                localStorage.setItem('notification', 'Please Verify your Email');
                location.assign('/sendotp/'+data.user);
              }
            }else {
              passwordError.textContent = 'Passwords dont match!';
            }
            
          }
          catch (err){
          }
        })


        function handleCheckboxClick() {
          const checkbox = document.getElementById('flexCheckDefault');
          const modalTriggerBtn = document.getElementById('modalTriggerBtn');
      
          if (checkbox.checked) {
            // Checkbox is checked, show the modal trigger button
            modalTriggerBtn.click();
          } else {
            // Checkbox is not checked, hide the modal trigger button
            modalTriggerBtn.style.display = 'none';
          }
        }
</script>

<%- include('./Partials/footer.ejs') %>
</body>
<%- include('./Partials/scripts.ejs') %>
</html>